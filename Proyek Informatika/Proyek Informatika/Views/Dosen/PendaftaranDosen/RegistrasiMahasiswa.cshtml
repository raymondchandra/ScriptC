@model Proyek_Informatika.Models.TopikView
@{
    ViewBag.Title = "Registrasi Mahasiswa";
}

<script type = "text/javascript">

    function onCommand(e) {
        if (e.name == "lihatDetail") {
            var text = "<table>";
            text += "<tr><td class='name'>NPM</td><td>&nbsp:&nbsp</td><td>" + e.row.cells[1].innerHTML + "</td></tr>";
            text += "<tr><td class='name'>Nama</td><td>&nbsp:&nbsp</td><td>" + e.row.cells[2].innerHTML + "</td></tr>";
            text += "<tr><td class='name'>Email</td><td>&nbsp:&nbsp</td><td>" + e.row.cells[3].innerHTML + "</td></tr>";
            text += "<tr><td class='name'>Telepon</td><td>&nbsp:&nbsp</td><td>" + e.row.cells[4].innerHTML + "</td></tr>";
            text += "<tr><td class='name'>Status</td><td>&nbsp:&nbsp</td><td>" + e.row.cells[5].innerHTML + "</td></tr>";
            text += "<tr><td class='name'>Judul</td><td>&nbsp:&nbsp</td><td>" + e.row.cells[6].innerHTML + "</td></tr>";
            text += "</table>";
            document.getElementById('detail').innerHTML = text;
            var windowZ = $("#mahasiswaDetail").data("tWindow");
            windowZ.center().open();
        }
        else if (e.name == "editDetail") {
            document.getElementById("idSkripsi").value = e.row.cells[0].innerHTML;
            document.getElementById("NPM").value = e.row.cells[1].innerHTML;
            document.getElementById("judul").value = e.row.cells[6].innerHTML;
            var windowZ = $("#mahasiswaUpdate").data("tWindow");
            windowZ.center().open();
        }
    }

    $(function () {
        $('#register')
            .click(function (e) {
                e.preventDefault();
                $("#mahasiswaInsert").data('tWindow').center().open();
            });
    });

</script>

<div class="layer">
    <h1>
        Mahasiswa</h1>
    @{var login = (string)Session["role"]; 
        if (login == "dosen")
        { 
        <button id="register" class="t-button t-state-default">Registrasi Mahasiswa</button>
        <br /><br />
        }    
    }    
    @{ 
        GridEditMode mode = GridEditMode.InLine;
        GridButtonType type = GridButtonType.Text;    
    }
    @(Html.Telerik().Grid<Proyek_Informatika.Models.MahasiswaView>()
        .HtmlAttributes(new { style = "width:100%" })
        .Name("Mahasiswa")  
        .DataKeys(keys =>
        {
            keys.Add(k => k.idSkripsi);
        })
        .DataBinding(dataBinding => dataBinding.Ajax()
            .Select("_SelectMahasiswa", "PendaftaranDosen")
            .Delete("_DeleteMahasiswa", "PendaftaranDosen"))
        .Columns(columns =>
        {
            columns.Bound(c => c.idSkripsi).Hidden();
            columns.Bound(c => c.NPM).Width(100).Title("NPM");
            columns.Bound(c => c.namaMahasiswa).Width(100).Title("Nama");
            columns.Bound(c => c.emailMahasiswa).Hidden();
            columns.Bound(c => c.teleponMahasiswa).Hidden();
            columns.Bound(c => c.status).Hidden();
            columns.Bound(c => c.judul).Width(300).Title("Judul");
            columns.Command(c => c.Custom("lihatDetail")
                .Text("Detail")
                .Ajax(true)).Width(95);
            columns.Command(c => c.Custom("editDetail")
                .Text("Edit")
                .Ajax(true)).Width(95);
            columns.Command(commands =>
            {
                commands.Delete().ButtonType(type);
            }).Width(95);
        })
        .ClientEvents(ev => ev.OnCommand("onCommand").OnComplete("onCommand"))
        .Editable(editing => editing.Mode(mode))
        .Pageable(p => p.PageSize(15))
        .Scrollable(c => c.Enabled(true))
        .Sortable()
        .Filterable()
        .Selectable()
        .Groupable()
    )

    @(Html.Telerik().Window()
        .Name("mahasiswaDetail")
        .Title("Detail Mahasiswa")
        .Visible(false)
        .Modal(true)
        .Width(500)
        .Height(250)
        .Scrollable(true)
        .Content(@<text> <p id="detail"></p></text>)
    )
    @(Html.Telerik().Window()
        .Name("mahasiswaUpdate")
        .Title("Edit")
        .Visible(false)
        .Modal(true)
        .Width(500)
        .Height(250)
        .Scrollable(true)
        .LoadContentFrom("MahasiswaUpdate", "PendaftaranDosen")
    )
    @(Html.Telerik().Window()
        .Name("mahasiswaInsert")
        .Title("Registrasi")
        .Visible(false)
        .Modal(true)
        .Width(500)
        .Height(250)
        .Scrollable(true)
        .LoadContentFrom("MahasiswaInsert", "PendaftaranDosen")
    )

    @section HeadContent {

<style type="text/css">
    /*--------------------validators--------------------*/
    .field-validation-error
    {
        position: absolute;
        display: block;
    }
    
    * html .field-validation-error { position: relative; }
    *+html .field-validation-error { position: relative; }    
    .field-validation-error span
    {
        position: absolute;
        white-space: nowrap;
        color: red;
        padding: 17px 5px 3px;
        background: transparent url('@Url.Content("~/Content/Common/validation-error-message.png") ') no-repeat 0 0;
    }
    
    /*--------------------in-form editing--------------------*/
    .t-edit-form-container
    {
        width: 350px;
        margin: 1em;
    }    
    .t-edit-form-container .editor-label,
    .t-edit-form-container .editor-field
    {
        padding-bottom: 1em;
        float: left;
    }    
    .t-edit-form-container .editor-label
    {
        width: 30%;
        text-align: right;
        padding-right: 3%;
        clear: left;
    }    
    .t-edit-form-container .editor-field
    {
        width: 60%;
    }
</style>
}
<style>
    #detail table
    {
        width:100%;    
    }
    td.name
    {
        width:25%;    
    }
    #detail table tr td
    {
        padding:5px;
        vertical-align:top;    
    }
</style>
</div>
