@using Proyek_Informatika.Models

<script type ="text/javascript">
    function OnComplete(e) {
        alert("file mahasiswa");
        if (e.name == "unduhFile") {
            window.open("Pengumpulan/GetDownload?id_laporan=" + e.dataItem.id, "_blank");
        }
        else if (e.name == "lihatFile") {
            var values = { id_laporan: e.dataItem.id };
            var id = e.dataItem.id;
            loadIframe("pdfContainer", "Pengumpulan/PDFViewer?id_laporan=" + id);
            var windowZ = $("#viewLaporan").data("tWindow");
            windowZ.center().open();
        }
        else if (e.name == "deskripsi") {
            var values = { id_laporan: e.dataItem.deskripsi };
            alert(e.dataItem.deskripsi);
        }
    }
    function loadIframe(iframeName, url) {
        var $iframe = $('#' + iframeName);
        if ($iframe.length) {
            $iframe.attr('src', url);
            return false;
        }
        return true;
    }
</script>

<div class ="layer">
<h1>File Mahasiswa</h1>

 <table>
            <tr>
                <td>Nama</td>
                <td>:</td>
                <td>@(ViewBag.nama)</td>
            </tr>
            <tr>
                <td>NPM</td>
                <td>:</td>
                <td>@(ViewBag.npm)</td>
            </tr>
            <tr>
                <td>Judul</td>
                <td>:</td>
                <td>@(ViewBag.judul)</td>
            </tr>
        </table><br/><br />
@(Html.Telerik().Grid<laporan>().HtmlAttributes(new { style = "width:100%" }).Name("TableFileMahasiswa")
.Columns(
    col =>
    {
        col.Bound(o => o.jenis).Title("Nama File");
        col.Bound(o => o.tanggal_pengumpulan).Title("Tanggal Pengumpulan");
        col.Command(com =>
        {
            com.Custom("unduhFile").Text("Unduh").Ajax(true);
            com.Custom("lihatFile").Text("Lihat").Ajax(true);
            //com.Custom("deskripsi").Text("Deskripsi").Ajax(true);
        })
        
        .Title("Aksi")
        .Width(100);
    }
)
.DetailView(det => det.ClientTemplate(
         "<fieldset>" +
             "<legend>Detil Bahasan</legend>" +
                 "<div class = 'deskripsi'><#= deskripsi #>" +
                 "</div>" +
         "</fieldset>"
    ))
            .ClientEvents(events => events.OnCommand("OnComplete"))
.DataBinding(data => data.Ajax().Select("SelectPengumpulan", "PengumpulanDosen", new {id_skripsi = ViewBag.id }))
.Pageable(p => p.PageSize(15))
.Sortable()
.Filterable()
.Scrollable(c => c.Enabled(true))
.Selectable()
.Groupable()
)
@(Html.Telerik().Window()
                .Name("viewLaporan")
                .Visible(false)
                .Title("Detil Bimbingan")
                .Modal(true)
                .Width(820)
                .Height(620)
                .Scrollable(true)
                .Content(@<text><iframe src="" id="pdfContainer" width ="800" height="600"></iframe></text>))

</div>